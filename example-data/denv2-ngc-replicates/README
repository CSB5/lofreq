# link files
#
ln -s ~/snpcaller/paper/ngc-nitd-pcr-replicates/GA004-SR-R00075/CTTGTA_2/corr/CTTGTA_2_remap_razers-i92_peakrem_corr.bam .
ln -s ~/snpcaller/paper/ngc-nitd-pcr-replicates/GA004-SR-R00075/CTTGTA_2/CTTGTA_2_remap_razers-i92_peakrem.covcons.fa .
ln -s ~/snpcaller/paper/ngc-nitd-pcr-replicates/GA004-SR-R00075/GGCTAC_2/corr/GGCTAC_2_remap_razers-i92_peakrem_corr.bam .
ln -s ~/snpcaller/paper/ngc-nitd-pcr-replicates/GA004-SR-R00075/GGCTAC_2/GGCTAC_2_remap_razers-i92_peakrem.covcons.fa .


# check whether exclude positions are identical and create copy
#

diff -u
 ~/snpcaller/paper/ngc-nitd-pcr-replicates/GA004-SR-R00075/CTTGTA_2/CTTGTA_2_remap_razers-i92.covpeaks.txt
 ~/snpcaller/paper/ngc-nitd-pcr-replicates/GA004-SR-R00075/GGCTAC_2/GGCTAC_2_remap_razers-i92.covpeaks.txt
 | grep -v '^#'  | wc -l
cat
 ~/snpcaller/paper/ngc-nitd-pcr-replicates/GA004-SR-R00075/CTTGTA_2/CTTGTA_2_remap_razers-i92.covpeaks.txt
 ~/snpcaller/paper/ngc-nitd-pcr-replicates/GA004-SR-R00075/GGCTAC_2/GGCTAC_2_remap_razers-i92.covpeaks.txt
 | grep -v '^#'  | sort -un > exclude.txt 


# call SNVs
#

bam=GGCTAC_2_remap_razers-i92_peakrem_corr.bam
ref=GGCTAC_2_remap_razers-i92_peakrem.covcons.fa
lofreq_snpcaller.py -b $bam -f $ref --baq off -e exclude.txt --bonf $(lofreq_bonf.py -i $bam -e exclude.txt -c consensus) -o GGCTAC_2_lofreq.snp -v

bam=CTTGTA_2_remap_razers-i92_peakrem_corr.bam 
ref=CTTGTA_2_remap_razers-i92_peakrem.covcons.fa
lofreq_snpcaller.py -b $bam -f $ref --baq off -e exclude.txt --bonf $(lofreq_bonf.py -i $bam -e exclude.txt -c consensus) -o CTTGTA_2_lofreq.snp


# the test directory contains a file checking sb-filtering, the diff and uniq module 